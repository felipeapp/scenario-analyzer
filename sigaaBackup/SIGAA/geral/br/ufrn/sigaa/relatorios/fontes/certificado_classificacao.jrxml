<?xml version="1.0" encoding="UTF-8"  ?>
<!-- Created with iReport - A designer for JasperReports -->
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN" "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">
<jasperReport
		 name="certificado_classificacao"
		 columnCount="1"
		 printOrder="Vertical"
		 orientation="Portrait"
		 pageWidth="536"
		 pageHeight="842"
		 columnWidth="480"
		 columnSpacing="0"
		 leftMargin="28"
		 rightMargin="28"
		 topMargin="20"
		 bottomMargin="20"
		 whenNoDataType="NoPages"
		 isTitleNewPage="false"
		 isSummaryNewPage="false">
	<property name="ireport.scriptlethandling" value="0" />
	<property name="ireport.encoding" value="UTF-8" />
	<import value="java.util.*" />
	<import value="net.sf.jasperreports.engine.*" />
	<import value="net.sf.jasperreports.engine.data.*" />

	<parameter name="idMatriz" isForPrompting="false" class="java.lang.Integer">
		<defaultValueExpression ><![CDATA[new Integer(99411)]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" isForPrompting="false" class="java.lang.String">
		<defaultValueExpression ><![CDATA[".\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="idConvocacao" isForPrompting="false" class="java.lang.Integer">
		<defaultValueExpression ><![CDATA[new Integer(194944059)]]></defaultValueExpression>
	</parameter>
	<parameter name="idProcessoSeletivo" isForPrompting="false" class="java.lang.Integer">
		<defaultValueExpression ><![CDATA[new Integer(2860174)]]></defaultValueExpression>
	</parameter>
	<parameter name="listaIdMatriz" isForPrompting="false" class="java.lang.String"/>
	<queryString><![CDATA[select ps.nome as concurso, SUBSTRING (ga.descricao, 1, 1) as descricao, t.sigla as sigla, c.nome as curso, rcc.semestre_aprovacao as semestre, iv.numero_inscricao as inscricao, pv.nome as nome, pv.numero_identidade as rg, 
  CASE pv.sexo WHEN 'F' THEN 'feminino' 
  ELSE CASE pv.sexo WHEN 'M' THEN 'masculino'
  ELSE 'INDEFINIDO' END END AS sexo,
  cps.descricao as listagem, rcc.id_resultado_classificacao_candidato as candidato, roc.argumento_final as argumento
  from vestibular.convocacao_processo_seletivo_discente cpsd
  LEFT JOIN vestibular.convocacao_processo_seletivo cps ON  (cpsd.id_convocacao_processo_seletivo = cps.id_convocacao_processo_seletivo) 
  LEFT JOIN vestibular.processo_seletivo ps ON (cps.id_processo_seletivo = ps.id_processo_seletivo) 
  LEFT JOIN vestibular.inscricao_vestibular iv using (id_inscricao_vestibular) 
  LEFT JOIN vestibular.resultado_classificacao_candidato rcc ON (iv.id_inscricao_vestibular = rcc.id_inscricao_vestibular) 
  LEFT JOIN vestibular.resultado_opcao_curso roc ON  (rcc.id_resultado_classificacao_candidato = roc.id_resultado_classificacao_candidato and rcc.opcao_aprovacao = roc.id_matriz_curricular ) 
  LEFT JOIN graduacao.matriz_curricular mc ON (mc.id_matriz_curricular = roc.id_matriz_curricular) 
  LEFT JOIN curso c ON (mc.id_curso = c.id_curso) 
  LEFT JOIN ensino.turno t ON (mc.id_turno = t.id_turno) 
  LEFT JOIN ensino.grau_academico ga ON (mc.id_grau_academico = ga.id_grau_academico) 
  LEFT JOIN discente d ON (cpsd.id_discente = d.id_discente) 
  LEFT JOIN graduacao.discente_graduacao dg ON dg.id_discente_graduacao = d.id_discente
  LEFT JOIN graduacao.curriculo curr ON (d.id_curriculo = curr.id_curriculo) 
  LEFT JOIN comum.pessoa pv ON (d.id_pessoa = pv.id_pessoa)
  LEFT JOIN comum.endereco en ON (en.id_endereco = pv.id_endereco_contato) 
  LEFT JOIN comum.municipio m ON (en.id_municipio = m.id_municipio) 
  LEFT JOIN comum.unidade_federativa uf ON (uf.id_unidade_federativa = m.id_unidade_federativa) 
  LEFT JOIN comum.unidade_federativa uf2 ON (uf2.id_unidade_federativa = pv.id_uf_naturalidade) 
  LEFT JOIN comum.pais p ON (uf2.id_pais = p.id_pais)  
  LEFT JOIN comum.estado_civil ec ON (pv.id_estado_civil = ec.id_estado_civil) 
  LEFT JOIN comum.unidade_federativa uf3 ON (uf3.id_unidade_federativa = pv.id_unidade_federativa_identidade) 
  LEFT JOIN comum.unidade_federativa uf4 ON (uf3.id_unidade_federativa = pv.id_unidade_federativa_titulo_eleitor) 
  LEFT JOIN comum.municipio m2 ON (c.id_municipio = m2.id_municipio)
  where dg.id_matriz_curricular = mc.id_matriz_curricular	
  and mc.id_matriz_curricular in $P!{listaIdMatriz}	
  and cps.id_convocacao_processo_seletivo = $P{idConvocacao}
  and ps.id_processo_seletivo = $P{idProcessoSeletivo}  
  and not exists (select id_resultado_opcao_curso from vestibular.resultado_opcao_curso
				where id_resultado_classificacao_candidato = rcc.id_resultado_classificacao_candidato 
				and id_matriz_curricular = roc.id_matriz_curricular
				and id_resultado_opcao_curso <> roc.id_resultado_opcao_curso
				and roc.classificacao = 0)
  order by c.nome, ga.descricao, t.sigla, rcc.semestre_aprovacao, pv.nome]]></queryString>

	<field name="concurso" class="java.lang.String"/>
	<field name="descricao" class="java.lang.String"/>
	<field name="sigla" class="java.lang.String"/>
	<field name="curso" class="java.lang.String"/>
	<field name="semestre" class="java.lang.Integer"/>
	<field name="inscricao" class="java.lang.Integer"/>
	<field name="nome" class="java.lang.String"/>
	<field name="rg" class="java.lang.String"/>
	<field name="sexo" class="java.lang.String"/>
	<field name="listagem" class="java.lang.String"/>
	<field name="candidato" class="java.lang.Integer"/>
	<field name="argumento" class="java.lang.Double"/>

		<background>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</background>
		<title>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</title>
		<pageHeader>
			<band height="100"  isSplitAllowed="true" >
				<image  evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						mode="Transparent"
						x="6"
						y="11"
						width="87"
						height="69"
						key="image-1"
						isPrintRepeatedValues="false"
						isRemoveLineWhenBlank="true"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<graphicElement stretchType="NoStretch"/>
					<imageExpression class="java.io.InputStream"><![CDATA[getClass().getResourceAsStream("/br/ufrn/sigaa/relatorios/fontes/brasao_ufrn.gif")]]></imageExpression>
				</image>
				<staticText>
					<reportElement
						x="93"
						y="1"
						width="375"
						height="20"
						key="staticText-1"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" pdfFontName="Helvetica-Bold" size="13" isBold="true"/>
					</textElement>
				<text><![CDATA[UNIVERSIDADE FEDERAL DO RIO GRANDE DO NORTE]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="93"
						y="21"
						width="365"
						height="16"
						key="staticText-2"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" pdfFontName="Helvetica-Bold" size="13" isBold="true"/>
					</textElement>
				<text><![CDATA[COMISSÃO PERMANENTE DO VESTIBULAR]]></text>
				</staticText>
				<textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="93"
						y="37"
						width="331"
						height="16"
						key="textField-6"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" pdfFontName="Helvetica-Bold" size="13" isBold="true"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{concurso}]]></textFieldExpression>
				</textField>
			</band>
		</pageHeader>
		<columnHeader>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</columnHeader>
		<detail>
			<band height="555"  isSplitAllowed="true" >
				<staticText>
					<reportElement
						x="13"
						y="-16"
						width="455"
						height="16"
						key="staticText-4"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" pdfFontName="Helvetica-Oblique" size="12" isBold="false" isItalic="true"/>
					</textElement>
				<text><![CDATA[Certificado de Classificação]]></text>
				</staticText>
				<textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="13"
						y="22"
						width="455"
						height="16"
						key="textField-1"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" pdfFontName="Helvetica-BoldOblique" size="11" isBold="true" isItalic="true"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{nome}.toUpperCase()]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="13"
						y="56"
						width="455"
						height="32"
						key="textField-2"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement verticalAlignment="Top">
						<font fontName="Arial" size="11"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA["Inscrição "+$F{inscricao}+", portador(a) da identidade "+$F{rg}+", do sexo "+$F{sexo}+", obteve classificação para o curso"]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="13"
						y="107"
						width="455"
						height="16"
						key="textField-3"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" pdfFontName="Helvetica-BoldOblique" size="11" isBold="true" isItalic="true"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{curso} + " - (" + $F{descricao}  + ")  (" + $F{sigla} + ")"]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="13"
						y="140"
						width="455"
						height="16"
						key="textField-4"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial" size="11"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA["no "+$F{semestre}+"° semestre, com os seguintes resultados:"]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="0"
						y="442"
						width="455"
						height="16"
						key="textField-5"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial" size="11"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA["obtendo Argumento de Classificação: "+$F{argumento}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="13"
						y="489"
						width="455"
						height="16"
						key="textField-7"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" size="11"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA["Natal, "+(new SimpleDateFormat("dd")).format(new java.util.Date())+" de " +
(new SimpleDateFormat("MMMM")).format(new java.util.Date()) +
" de " +
(new SimpleDateFormat("yyyy")).format(new java.util.Date())]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement
						x="13"
						y="529"
						width="455"
						height="20"
						key="staticText-6"
						isRemoveLineWhenBlank="true"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" size="11"/>
					</textElement>
				<text><![CDATA[P/ COMPERVE]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="90"
						y="164"
						width="300"
						height="16"
						key="staticText-7"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font fontName="Arial" size="11"/>
					</textElement>
				<text><![CDATA[Provas com questões de Múltipla Escolha]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="90"
						y="318"
						width="300"
						height="16"
						key="staticText-8"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font fontName="Arial" size="11"/>
					</textElement>
				<text><![CDATA[Provas com questões Discursivas]]></text>
				</staticText>
				<subreport  isUsingCache="true">
					<reportElement
						x="90"
						y="180"
						width="300"
						height="20"
						key="subreport-1"
						stretchType="RelativeToTallestObject"/>
					<subreportParameter  name="candidato">
						<subreportParameterExpression><![CDATA[$F{candidato}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter  name="fase">
						<subreportParameterExpression><![CDATA[new Integer(1)]]></subreportParameterExpression>
					</subreportParameter>
					<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					<subreportExpression  class="java.io.InputStream"><![CDATA[this.getClass().getResourceAsStream($P{SUBREPORT_DIR} + "notas_candidato.jasper")]]></subreportExpression>
				</subreport>
				<subreport  isUsingCache="true">
					<reportElement
						x="90"
						y="334"
						width="300"
						height="20"
						key="subreport-2"
						stretchType="RelativeToTallestObject"/>
					<subreportParameter  name="candidato">
						<subreportParameterExpression><![CDATA[$F{candidato}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter  name="fase">
						<subreportParameterExpression><![CDATA[new Integer(2)]]></subreportParameterExpression>
					</subreportParameter>
					<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					<subreportExpression  class="java.io.InputStream"><![CDATA[this.getClass().getResourceAsStream($P{SUBREPORT_DIR} + "notas_candidato.jasper")]]></subreportExpression>
				</subreport>
			</band>
		</detail>
		<columnFooter>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</columnFooter>
		<pageFooter>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</pageFooter>
		<summary>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</summary>
</jasperReport>
