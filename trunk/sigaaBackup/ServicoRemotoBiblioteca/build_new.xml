<?xml version="1.0"?>
<!--========================================================
Arquivo de Build dos Projetos UFRN
Autor: Romulo Fagundes Cantanhede
=========================================================-->

<project name="DeployServicoRemotoBiblioteca" default="deployLocal" basedir=".">

	<!-- Build Properties -->
	<property file="build_new.properties" />

	<path id="buildworkspace.classpath">
		<fileset file="${tmpProject}/${project}/arq.jar"/>
		<fileset dir="../LIBS/" includes="**/*.jar" />
	</path>
	
	<path id="buildintegradora.classpath">
		<fileset file="./dependencias/arq-${versaoArquitetura}.jar"/>
		<fileset dir="../LIBS/" includes="**/*.jar" />
	</path>
	
	<target name="init-workspace" depends="init">
		<mkdir dir="${tmpProject}/${project}/buildArq"/>
	</target>
	
	<target name="build-deps" depends="init-workspace">
		<javac destdir="${tmpProject}/${project}/buildArq" nowarn="on" debug="false" srcdir="../01_Arquitetura">
			<classpath refid="buildworkspace.classpath" />
			<exclude name="**/package-info.java" />
		</javac>
		<copy todir="${tmpProject}/${project}/buildArq">
		    <fileset dir="../01_Arquitetura/src" includes="**/*.xml,**/*.properties" />
			<fileset dir="../01_Arquitetura/comum" includes="**/*.xml,**/*.properties" />
			<fileset dir="../01_Arquitetura/ambientes" includes="**/*.xml,**/*.properties" />
			<fileset dir="../01_Arquitetura/services" includes="**/*.xml,**/*.properties" />
		</copy>
		<jar file="${tmpProject}/${project}/arq.jar" basedir="${tmpProject}/${project}/buildArq" />
	</target>

	<target name="clean">
		<delete dir="${tmpProject}\${project}" failonerror="false" />
	</target>

	<target name="init" depends="clean">
		<tstamp />
		<mkdir dir="${tmpProject}" />
		<mkdir dir="${tmpProject}/${project}" />
		<mkdir dir="${tmpProject}/${project}/build${project}" />
	</target>

	
	<target name="jar-local" depends="build-deps">
		<javac destdir="${tmpProject}/${project}/build${project}" nowarn="on" debug="false" srcdir=".">
			<classpath refid="buildworkspace.classpath" />
			<exclude name="**/package-info.java" />
		</javac>
		<copy todir="${tmpProject}/${project}/build${project}">
		    <fileset dir="src" includes="**/*.xml,**/*.properties" />
		</copy>
		<jar file="${tmpProject}/${project}/${nomeSistema}-${versaoServicosBiblioteca}.jar" basedir="${tmpProject}/${project}/build${project}" />
	</target>
	
	<target name="jar-integradora">
		<javac destdir="${tmpProject}/${project}/build${project}" nowarn="on" debug="false" srcdir=".">
			<classpath refid="buildintegradora.classpath" />
			<exclude sname="**/package-info.java" />
		</javac>
		<copy todir="${tmpProject}/${project}/build${project}">
		    <fileset dir="src" includes="**/*.xml,**/*.properties" />
		</copy>
		<jar file="${tmpProject}/${project}/${nomeSistema}-${versaoServicosBiblioteca}.jar" basedir="${tmpProject}/${project}/build${project}" />
	</target>

	<target name="copyLocal">
		<copy tofile="${libLocal}/${nomeSistema}.jar">
			<fileset file="${tmpProject}/${project}/${nomeSistema}-${versaoServicosBiblioteca}.jar" />
		</copy>
	</target>

	<target name="deployLocal">
		<antcall inheritall="all" target="init"/>
		<antcall inheritall="all" target="jar-local"/>
		<antcall inheritall="all" target="copyLocal" />
	</target>
	<target name="deployIntegradora">
		<antcall inheritall="all" target="init"/>
		<antcall inheritall="all" target="jar-integradora"/>
		<antcall inheritall="all" target="copyLocal" />
	</target>
</project>